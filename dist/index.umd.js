!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e||self).InsertText=t()}(this,function(){class e{constructor(e){this.element="string"==typeof e?document.querySelector(e):e;var n=this.element.tagName.toLowerCase();this.target="input"==n||"textarea"==n?new t(this.element):new s(this.element)}run(e,t){this.element.focus(),this.target.insert(e,t),this.element.focus()}static run(t,s,n){void 0===n&&(n="caret"),new e(t).run(s,n)}}class t{constructor(e){this.element=e}insert(e,t){switch(t){case"caret":this.insertAtCaret(e);break;case"first":this.insertAt(e,0);break;case"last":this.insertAt(e,this.element.value.length);break;default:this.insertAt(e,t)}}insertAtCaret(e){this.insertAt(e,this.element.selectionStart,this.element.selectionEnd)}insertAt(e,t,s){void 0===s&&(s=null),s=s||t;var n=this.element.value;this.element.value=""+n.substring(0,t)+e+n.substring(s);var r=t+e.length;this.element.setSelectionRange(r,r)}}class s{constructor(e){this.element=e}insert(e,t){switch(t){case"caret":this.insertAtCaret(e);break;case"first":this.insertAtFirst(e);break;case"last":this.insertAtLast(e);break;default:this.insertAt(e,t.selector,t.position)}}insertAtCaret(e){var t,s=this.createNode(e),n=window.getSelection();n.rangeCount>0?t=n.getRangeAt(0):(t=document.createRange()).setStart(this.element,0),t.deleteContents(),t.insertNode(s),t.setStartAfter(s),n.removeAllRanges(),n.addRange(t)}insertAtFirst(e){var t=this.createNode(e);this.element.prepend(t),this.adjustSelection(t)}insertAtLast(e){var t=this.createNode(e);this.element.append(t),this.adjustSelection(t,!1)}insertAt(e,t,s){this.element.querySelectorAll(t).forEach(t=>{var n=Array.from(t.childNodes).find(e=>3==e.nodeType),r=this.createNode(e),i=document.createRange();i.setStart(n,s),i.insertNode(r)})}createNode(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}adjustSelection(e,t){void 0===t&&(t=!0);var s=window.getSelection(),n=document.createRange();t?n.setStartAfter(e):n.setStartBefore(e),n.collapse(!0),s.removeAllRanges(),s.addRange(n)}}return e});
//# sourceMappingURL=index.umd.js.map
